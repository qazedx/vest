<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>

<head>
  <title>TODO supply a title</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!--jq-->
  <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
  <!--bs-->
  <link href="lib/bs/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href="bower_components/chartist/dist/chartist.min.css">
  <script src="lib/bs/js/bootstrap.min.js" type="text/javascript"></script>
  <script src="bower_components/chartist/dist/chartist.min.js"></script>
  <!--<link href="style.css" rel="stylesheet" type="text/css"/>-->
</head>

<body>

  <div class="ct-chart ct-perfect-fourth"></div>
  <!-- <div class="ct-chart ct-golden-section" id="chart2"></div> -->
  <script>
    var domain = document.domain;
    // var ws = new WebSocket('ws://' + domain + ':8770/');
    var host = location.origin.replace(/^http/, 'ws')
    var ws = new WebSocket(host);
    ws.open = function(event) {
      // ws.send('something');
    };

    ws.onmessage = function(event) {

      console.log(event.data);
      message = JSON.parse(event.data);
    //  data.series[0].push(message.series[0]);
    //  data.series[1].push(message.series[1]);
    //  data.series[2].push(message.series[2]);
    //  console.log(data);
   draw(message)
    };
    ws.onclose = function(event) {
      console.log('err');
      setTimeout(function() {
        location.reload();
      }, 100);
    };
    //ws end

    var data = {
      // A labels array that can contain any sort of values
      labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri'],
      // Our series array that contains series objects or in this case series data arrays
      series: [
        [12, 9, 7, 8, 5,8,9],
        [2, 1, 3.5, 7, 3,6,4],
        [1, 3, 4, 5, 6,2,5]
      ]
    };

    // Create a new line chart object where as first parameter we pass in a selector
    // that is resolving to our chart container element. The Second parameter
    // is the actual data object.
    function draw(data){
      new Chartist.Line('.ct-chart', data);
    }
      new Chartist.Line('.ct-chart', data);
  </script>

</body>

</html>
